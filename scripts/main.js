function getBrowser(){var e=uaMatch(navigator.userAgent),a={};return e.browser&&(a[e.browser]=!0,a.version=e.version),a.chrome?a.webkit=!0:a.webkit&&(a.safari=!0),a}function uaMatch(e){e=e.toLowerCase();var a=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:a[1]||"",version:a[2]||"0"}}!function(e){function a(a){var f=a||window.event,t=[].slice.call(arguments,1),d=0,c=0,n=0;return a=e.event.fix(f),a.type="mousewheel",f.wheelDelta&&(d=f.wheelDelta/120),f.detail&&(d=-f.detail/3),n=d,void 0!==f.axis&&f.axis===f.HORIZONTAL_AXIS&&(n=0,c=-1*d),void 0!==f.wheelDeltaY&&(n=f.wheelDeltaY/120),void 0!==f.wheelDeltaX&&(c=-1*f.wheelDeltaX/120),t.unshift(a,d,c,n),(e.event.dispatch||e.event.handle).apply(this,t)}var f=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var t=f.length;t;)e.event.fixHooks[f[--t]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=f.length;e;)this.addEventListener(f[--e],a,!1);else this.onmousewheel=a},teardown:function(){if(this.removeEventListener)for(var e=f.length;e;)this.removeEventListener(f[--e],a,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery);var colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};!function(e){e.scrollorama=function(a){function f(){var a,f,d=!1;"string"==typeof b.settings.blocks&&(b.settings.blocks=e(b.settings.blocks));var c=getBrowser();for(c.mozilla&&(l="-moz-"),c.webkit&&(l="-webkit-"),c.opera&&(l="-o-"),c.msie&&(l="-ms-",p=parseInt(c.version,10)),e("body").css("position","relative"),a=0;a<b.settings.blocks.length;a++)f=b.settings.blocks.eq(a),d=f.css("margin-top"),s.push({block:f,top:f.offset().top-(Boolean(d)?0:parseInt(d,10)),pin:0,animations:[]});if("true"===b.settings.enablePin.toString())for(a=0;a<s.length;a++)s[a].block.css("position","absolute").css("top",s[a].top);0===e("#scroll-wrap").length&&e("body").prepend('<div id="scroll-wrap"></div>'),h=0,m=!1,e(window).on("scroll.scrollorama",t)}function t(){h=window.scrollY,d()}function d(){m||g(function(){n(),c()}),m=!0}function c(){m=!1}function n(){var a,f,t,d,c,n,i,l=e(window).scrollTop(),p=o(l);for(a=0;a<s.length;a++)if(s[a].animations.length)for(f=0;f<s[a].animations.length;f++)t=s[a].animations[f],a>p?(p!==a-1&&"bottom"!==t.baseline&&r(t,t.startVal),s[a].pin&&s[a].block.css("position","absolute").css("top",s[a].top)):p>a&&(r(t,t.endVal),s[a].pin&&s[a].block.css("position","absolute").css("top",s[a].top+s[a].pin)),(a===p||p===a-1&&"bottom"===t.baseline)&&(s[a].pin&&p===a&&s[a].block.css("position","fixed").css("top",0),d=s[a].top+t.delay,"bottom"===t.baseline&&(d-=e(window).height()),c=d+t.duration,d>l?r(t,t.startVal):l>c?(r(t,t.endVal),s[a].pin&&s[a].block.css("position","absolute").css("top",s[a].top+s[a].pin)):(n=(l-d)/t.duration,t.easing&&e.isFunction(e.easing[t.easing])&&(n=e.easing[t.easing](n,1e3*n,0,1,1e3)),i=t.startVal+n*(t.endVal-t.startVal),r(t,i)));b.blockIndex!==p&&(b.blockIndex=p,u())}function o(e){var a,f=0;for(a=0;a<s.length;a++)s[a].top<=e-b.settings.offset&&(f=a);return f}function r(a,f){var t,d,c=a.element,n=a.property;"rotate"===n||"zoom"===n||"scale"===n?"rotate"===n?c.css(l+"transform","rotate("+f+"deg)"):("zoom"===n||"scale"===n)&&(t="scale("+f+")","-ms-"!==l?c.css(l+"transform",t):(jQuery().scale&&e(c.selector).scale(f),c.css("zoom",f))):"background-position-x"===n||"background-position-y"===n?(d=c.css("background-position").split(" "),"background-position-x"===n&&c.css("background-position",f+"px "+d[1]),"background-position-y"===n&&c.css("background-position",d[0]+" "+f+"px")):"text-shadow"===n?c.css(n,"0px 0px "+f+"px #ffffff"):a.suffix?c.css(n,f+a.suffix):c.css(n,f)}var b={},s=[],l="",p="",u=function(){},h=0,m=!1,g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},v={offset:0,enablePin:!0};return b.settings=e.extend({},v,a),b.blockIndex=0,void 0===a.blocks&&alert("ERROR: Must assign blocks class selector to scrollorama plugin"),b.animate=function(a){var f,t,d,c,o,r,i;for("string"==typeof a&&(a=e(a)),r=0;r<s.length;r++)s[r].block.has(a).length&&(t=s[r],f=r);for(r=1;r<arguments.length;r++)if(d=arguments[r],("top"===d.property||"left"===d.property||"bottom"===d.property||"right"===d.property)&&("static"===a.css("position")&&a.css("position","relative"),cssValue=parseInt(a.css(d.property),10),void 0===d.start?d.start=isNaN(cssValue)?0:cssValue:void 0===d.end&&(d.end=isNaN(cssValue)?0:cssValue)),"rotate"===d.property?(void 0===d.start&&(d.start=0),void 0===d.end&&(d.end=0)):"zoom"===d.property||"scale"===d.property?(void 0===d.start&&(d.start=1),void 0===d.end&&(d.end=1)):"letter-spacing"===d.property&&a.css(d.property)&&(void 0===d.start&&(d.start=1),void 0===d.end&&(d.end=1)),p&&9>p&&("background-position-x"==d.property||"background-position-y"==d.property)&&(d.property="background-position-x"===d.property?"backgroundPositionX":"backgroundPositionY"),void 0===d.baseline&&(d.baseline=d.pin||t.pin||0===f?"top":"bottom"),void 0===d.delay&&(d.delay=0),startVal=void 0!==d.start?"function"==typeof d.start?d.start():d.start:parseInt(a.css(d.property),10),endVal=void 0!==d.end?"function"==typeof d.end?d.end():d.end:parseInt(a.css(d.property),10),o=startVal.toString().match(/\D+$/)||endVal.toString().match(/\D+$/),o&&(o=o[0],startVal=parseInt(startVal,10),endVal=parseInt(endVal,10)),t.animations.push({element:a,delay:d.delay,duration:d.duration,property:d.property,startVal:startVal,endVal:endVal,suffix:o,baseline:void 0!==d.baseline?d.baseline:"bottom",easing:d.easing}),d.pin&&t.pin<d.duration+d.delay)for(c=d.duration+d.delay-t.pin,t.pin+=c,i=f+1;i<s.length;i++)s[i].top+=c,s[i].block.css("top",s[i].top);return n(),b},b.onBlockChange=function(e){u=e},b.getScrollpoints=function(){var e,a,f,t=[];for(e=0;e<s.length;e++)if(t.push(s[e].top),s[e].animations.length&&s[e].pin>0)for(a=0;a<s[e].animations.length;a++)f=s[e].animations[a],t.push(s[e].top+f.delay+f.duration);return t.sort(function(e,a){return e-a}),t},b.destroy=function(){for(i=0;i<s.length;i++)s[i].block.css({top:"",position:""}),delete s[i].animations,delete s[i].top,delete s[i].pin;e(window).off("scroll.scrollorama"),e("#scroll-wrap").remove(),delete b},f(),b},e.extend(e.easing,{def:"easeOutQuad",swing:function(a,f,t,d,c){return e.easing[e.easing.def](a,f,t,d,c)},easeInQuad:function(e,a,f,t,d){return t*(a/=d)*a+f},easeOutQuad:function(e,a,f,t,d){return-t*(a/=d)*(a-2)+f},easeInOutQuad:function(e,a,f,t,d){return(a/=d/2)<1?t/2*a*a+f:-t/2*(--a*(a-2)-1)+f},easeInCubic:function(e,a,f,t,d){return t*(a/=d)*a*a+f},easeOutCubic:function(e,a,f,t,d){return t*((a=a/d-1)*a*a+1)+f},easeInOutCubic:function(e,a,f,t,d){return(a/=d/2)<1?t/2*a*a*a+f:t/2*((a-=2)*a*a+2)+f},easeInQuart:function(e,a,f,t,d){return t*(a/=d)*a*a*a+f},easeOutQuart:function(e,a,f,t,d){return-t*((a=a/d-1)*a*a*a-1)+f},easeInOutQuart:function(e,a,f,t,d){return(a/=d/2)<1?t/2*a*a*a*a+f:-t/2*((a-=2)*a*a*a-2)+f},easeInQuint:function(e,a,f,t,d){return t*(a/=d)*a*a*a*a+f},easeOutQuint:function(e,a,f,t,d){return t*((a=a/d-1)*a*a*a*a+1)+f},easeInOutQuint:function(e,a,f,t,d){return(a/=d/2)<1?t/2*a*a*a*a*a+f:t/2*((a-=2)*a*a*a*a+2)+f},easeInSine:function(e,a,f,t,d){return-t*Math.cos(a/d*(Math.PI/2))+t+f},easeOutSine:function(e,a,f,t,d){return t*Math.sin(a/d*(Math.PI/2))+f},easeInOutSine:function(e,a,f,t,d){return-t/2*(Math.cos(Math.PI*a/d)-1)+f},easeInExpo:function(e,a,f,t,d){return 0===a?f:t*Math.pow(2,10*(a/d-1))+f},easeOutExpo:function(e,a,f,t,d){return a===d?f+t:t*(-Math.pow(2,-10*a/d)+1)+f},easeInOutExpo:function(e,a,f,t,d){return 0===a?f:a===d?f+t:(a/=d/2)<1?t/2*Math.pow(2,10*(a-1))+f:t/2*(-Math.pow(2,-10*--a)+2)+f},easeInCirc:function(e,a,f,t,d){return-t*(Math.sqrt(1-(a/=d)*a)-1)+f},easeOutCirc:function(e,a,f,t,d){return t*Math.sqrt(1-(a=a/d-1)*a)+f},easeInOutCirc:function(e,a,f,t,d){return(a/=d/2)<1?-t/2*(Math.sqrt(1-a*a)-1)+f:t/2*(Math.sqrt(1-(a-=2)*a)+1)+f},easeInElastic:function(e,a,f,t,d){var c=1.70158,n=0,o=t;return 0===a?f:1===(a/=d)?f+t:(n||(n=.3*d),o<Math.abs(t)?(o=t,c=n/4):c=n/(2*Math.PI)*Math.asin(t/o),-(o*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-c)*Math.PI/n))+f)},easeOutElastic:function(e,a,f,t,d){var c=1.70158,n=0,o=t;return 0===a?f:1===(a/=d)?f+t:(n||(n=.3*d),o<Math.abs(t)?(o=t,c=n/4):c=n/(2*Math.PI)*Math.asin(t/o),o*Math.pow(2,-10*a)*Math.sin(2*(a*d-c)*Math.PI/n)+t+f)},easeInOutElastic:function(e,a,f,t,d){var c=1.70158,n=0,o=t;return 0===a?f:2===(a/=d/2)?f+t:(n||(n=.3*d*1.5),o<Math.abs(t)?(o=t,c=n/4):c=n/(2*Math.PI)*Math.asin(t/o),1>a?-.5*o*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-c)*Math.PI/n)+f:o*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-c)*Math.PI/n)*.5+t+f)},easeInBack:function(e,a,f,t,d,c){return void 0===c&&(c=1.70158),t*(a/=d)*a*((c+1)*a-c)+f},easeOutBack:function(e,a,f,t,d,c){return void 0===c&&(c=1.70158),t*((a=a/d-1)*a*((c+1)*a+c)+1)+f},easeInOutBack:function(e,a,f,t,d,c){return void 0===c&&(c=1.70158),(a/=d/2)<1?t/2*a*a*(((c*=1.525)+1)*a-c)+f:t/2*((a-=2)*a*(((c*=1.525)+1)*a+c)+2)+f},easeInBounce:function(a,f,t,d,c){return d-e.easing.easeOutBounce(a,c-f,0,d,c)+t},easeOutBounce:function(e,a,f,t,d){return(a/=d)<1/2.75?7.5625*t*a*a+f:2/2.75>a?t*(7.5625*(a-=1.5/2.75)*a+.75)+f:2.5/2.75>a?t*(7.5625*(a-=2.25/2.75)*a+.9375)+f:t*(7.5625*(a-=2.625/2.75)*a+.984375)+f},easeInOutBounce:function(a,f,t,d,c){return c/2>f?.5*e.easing.easeInBounce(a,2*f,0,d,c)+t:.5*e.easing.easeOutBounce(a,2*f-c,0,d,c)+.5*d+t}})}(jQuery),function(e){"use strict";var a=function(e){function a(e){queue().defer(d3.json,"data/world.json").defer(d3.json,"data/us.json").defer(d3.json,"data/hurricane-2004-small.json").await(function(a,t,d,c){f.initMajorCanes(a,t,d,c,e)})}console.log("init KAT5, options: ",e);var f=this;this.effects(),this.options=e,this._isAnimating=!0,queue().defer(d3.json,"data/world-50.json").defer(d3.json,"data/us.json").defer(d3.json,"data/katrina-track.json").defer(d3.json,"data/hurricane-2005-small.json").await(function(e,t,d,c,n){f.initTrackMap(e,t,d,c,n),a(n)}),this.wireScrollTricks(),this.initPopulationMap(),this.initOrleansChart(),this.initPeopleChart(),this.initHomesChart(),this.initJobsCharts(),this.wire()};a.prototype.wireScrollTricks=function(){var a,f=this;$(e).scroll(function(f){a=$(e).scrollTop()});var t=document.getElementById("player");t.volume=0;{var d=(new Waypoint({element:document.getElementById("section-human-toll"),handler:function(e){"down"===e?($("#volume").show(),t.currentTime=50,setTimeout(function(){$("#player").animate({volume:.2},3e3)},200)):"up"===e&&($("#volume").fadeOut(),$("#player").animate({volume:0},3e3))}}),new Waypoint({element:document.getElementById("section-levee-up"),handler:function(e){"down"===e?($("#volume").fadeOut(),$("#player").animate({volume:0},3e3)):"up"===e&&($("#volume").show(),$("#player").animate({volume:.2},3e3))}}),new Waypoint({element:document.getElementById("section-intro"),handler:function(e){"down"===e?($("#volume").css({"background-color":"#FFF"}),$("#brand-fixed").show()):($("#volume").hide(),$("#volume").css({"background-color":"#888"}),$("#brand-fixed").hide())},offset:-$("#section-intro").height()}),$(e).height()/1.5);new Waypoint({element:document.getElementById("major-canes-map"),handler:function(e){"down"===e&&f.zoomGlobe()},offset:d}),new Waypoint({element:document.getElementById("major-canes-map"),handler:function(e){"up"===e&&f.resetGlobe()},offset:$(e).height()})}},a.prototype.initMajorCanes=function(e,a,f,t,d){var c=this,n={top:10,left:0,bottom:10,right:0},o=parseInt(d3.select("#katrina-track-map").style("width")),o=o-n.left-n.right,r=.5,b=o*r;console.log("width:",o),console.log("height:",b),$("#map-overlay").css({height:b+"px"});d3.scale.quantile().domain([0,140]).range(colorbrewer.YlOrRd[9]);this.majorProjection=d3.geo.orthographic().scale(325).translate([o/2,b/2]).clipAngle(90).rotate([-50,-20]).precision(.1),this.majorPath=d3.geo.path().projection(this.majorProjection),this.majorSvg=d3.select("#major-canes-map").append("svg").attr("width",o).attr("height",b);d3.scale.linear().domain([0,o]).range([-180,180]),d3.scale.linear().domain([0,b]).range([90,-90]);if(e)throw e;console.log("world",a,"states",f,"hurricane TWo!!",d),c.majorSvg.append("defs").append("path").datum({type:"Sphere"}).attr("id","sphere").attr("d",c.majorPath),c.majorSvg.append("use").attr("class","fill-ocean").attr("xlink:href","#sphere"),c.majorSvg.append("g").attr("class","major-states").selectAll("path").data(topojson.feature(a,a.objects.ne_110m_land).features).enter().append("path").attr("class","state").attr("d",c.majorPath),c.majorSvg.append("g").attr("class","major-states").selectAll("path").data(topojson.feature(f,f.objects.states).features).enter().append("path").attr("class","state").attr("d",c.majorPath),c.majorSvg.append("g").selectAll("path").data(topojson.feature(t,t.objects["2004hur"]).features).enter().append("path").attr("class","hurricane").attr("opacity",function(e){return"IVAN"===e.properties.Name||"CHARLEY"===e.properties.Name||"JEANNE"===e.properties.Name?1:0}).attr("stroke",function(e){return"NA"!==e.properties.basin?"rgb(0, 194, 255)":e.properties.ATC_wind<64?"#3498db":e.properties.ATC_wind>64&&e.properties.ATC_wind<82?"#f1c40f":e.properties.ATC_wind>=82&&e.properties.ATC_wind<95?"#f39c12":e.properties.ATC_wind>=95&&e.properties.ATC_wind<112?"#e67e22":e.properties.ATC_wind>=112&&e.properties.ATC_wind<136?"#d35400":e.properties.ATC_wind>=136?"#c0392b":void 0}).attr("d",c.majorPath),c.majorSvg.append("g").selectAll("path").data(topojson.feature(d,d.objects["2005hur"]).features).enter().append("path").attr("class","hurricane").attr("opacity",function(e){
return"KATRINA"===e.properties.Name||"DENNIS"===e.properties.Name||"WILMA"===e.properties.Name||"RITA"===e.properties.Name?1:0}).attr("stroke",function(e){return"NA"!==e.properties.basin?"rgb(0, 194, 255)":e.properties.ATC_wind<64?"#3498db":e.properties.ATC_wind>64&&e.properties.ATC_wind<82?"#f1c40f":e.properties.ATC_wind>=82&&e.properties.ATC_wind<95?"#f39c12":e.properties.ATC_wind>=95&&e.properties.ATC_wind<112?"#e67e22":e.properties.ATC_wind>=112&&e.properties.ATC_wind<136?"#d35400":e.properties.ATC_wind>=136?"#c0392b":void 0}).attr("d",c.majorPath),d3.select(c.frameElement).style("height",b+"px")},a.prototype.zoomGlobe=function(){var e=this,a=20,f=325;e.majorProjection&&d3.transition().duration(3e3).tween("rotate",function(){var t=d3.interpolate(e.majorProjection.rotate(),[70,-20]);return function(d){e.majorProjection.rotate(t(d)),e.majorProjection.scale(f+a),e.majorSvg.selectAll("path").attr("d",e.majorPath),f+=a}})},a.prototype.resetGlobe=function(){var e=this;console.log("reset globe"),e.majorProjection.rotate([-50,-20]),e.majorProjection.scale(325),e.majorSvg.selectAll("path").attr("d",e.majorPath)},a.prototype.initTrackMap=function(e,a,f,t,d){var c=this,n={top:10,left:0,bottom:10,right:0},o=parseInt(d3.select("#katrina-track-map").style("width")),o=o-n.left-n.right,r=.5,b=o*r;console.log("width:",o),console.log("height:",b),$("#map-overlay").css({height:b+"px"});var i=["#3498db","#f1c40f","#f39c12","#e67e22","#d35400","#c0392b"],s=d3.scale.quantile().domain([30,150]).range(i);if(console.log("width",o),console.log("mapRatio",r),this.trackProjection=d3.geo.conicConformal().rotate([80,0]).center([0,28]).parallels([29.5,45.5]).scale(o).translate([o/2,b/2]).precision(.1),this.trackPath=d3.geo.path().projection(this.trackProjection).pointRadius(function(e){return e.properties["Wind(WMO)"]/10}),this.trackSvg=d3.select("#katrina-track-map").append("svg").attr("width",o).attr("height",b),e)throw e;console.log("world",a,"states",f),c.trackSvg.append("g").attr("class","states").selectAll("path").data(topojson.feature(a,a.objects.ne_50m_land).features).enter().append("path").attr("class","state").attr("d",c.trackPath),c.trackSvg.append("g").attr("class","states").selectAll("path").data(topojson.feature(f,f.objects.states).features).enter().append("path").attr("class","state").attr("d",c.trackPath),console.log("tracks: ",t),c.trackSvg.append("g").selectAll("path").data(topojson.feature(d,d.objects["2005hur"]).features).enter().append("path").attr("class","hurricane").attr("opacity",function(e){return"KATRINA"===e.properties.Name?1:0}).attr("stroke",function(e){return s(e.properties.ATC_wind)}).attr("d",c.trackPath),c.trackSvg.selectAll("circle").data(t.features).enter().append("circle").attr("r",0).attr("class","track-outer").attr("transform",function(e){return"translate("+c.trackProjection([e.geometry.coordinates[0],e.geometry.coordinates[1]])+")"}),c.trackSvg.selectAll("circle.inner").data(t.features).enter().append("circle").attr("r",0).attr("class","track").attr("transform",function(e){return"translate("+c.trackProjection([e.geometry.coordinates[0],e.geometry.coordinates[1]])+")"}).attr("fill",function(e){return s(e.properties["Wind(WMO)"])}).on("mouseenter",function(e){c._isAnimating=!1,d3.select(this).transition().duration(500).attr("r",function(e){return e.properties["Wind(WMO)"]/5}),c._trackInfo(e)}).on("mouseleave",function(e){d3.select(this).transition().duration(500).attr("r",function(e){return e.properties["Wind(WMO)"]/10}),$("#track-infowin").hide(),c._isAnimating=!0,setTimeout(function(){console.log("self._isAnimating",c._isAnimating),c._isAnimating&&c._animateTrack()},1e3)}),setTimeout(function(){c._animateTrack()},2500),d3.select(c.frameElement).style("height",b+"px")},a.prototype._animateTrack=function(){var e=this;if(this._isAnimating){d3.selectAll(".track").attr("r",0).each(function(e,a){d3.select(this).transition().delay(180*a).duration(3e3).attr("r",function(e){return e.properties["Wind(WMO)"]/10}).each("start",function(e){})});var a=0;d3.selectAll(".track-outer").attr("r",0).each(function(f,t){d3.select(this).transition().delay(180*t).duration(3e3).attr("r",function(e){return e.properties["Wind(WMO)"]/2.5}).each("end",function(f,t){a++,34===a&&($("#report-date").html(""),e._isAnimating&&(setTimeout(function(){d3.selectAll(".track").transition().duration(1e3).attr("r",0),d3.selectAll(".track-outer").transition().duration(1e3).attr("r",0)},1700),setTimeout(function(){e._animateTrack()},2900)))})})}},a.prototype._trackInfo=function(e){var a,f=this.trackProjection([e.geometry.coordinates[0],e.geometry.coordinates[1]])[0]+84,t=this.trackProjection([e.geometry.coordinates[0],e.geometry.coordinates[1]])[1]-120,d=e.properties.ISO_time,c=e.properties["Wind(WMO)"],n=e.properties["Pres(WMO)"];a='<div>        <div class="track-attr-title">Date: '+d+'</div>        <div class="track-attr-title">Wind (WMO): '+c+'</div>        <div class="track-attr-title">Pressure (WMO): '+n+"</div>      </div>",$("#track-infowin").show().html(a).css({left:f+"px",top:t+"px"})},a.prototype._popInfo=function(e,a,f){var t;console.log("d",e),f-=70,a-=75;var d=e.properties.NAME,c=this.popChange.year06.get(e.properties.STATE_FIPS+e.properties.CNTY_FIPS).toLocaleString();t='<div>        <div class="track-attr-title">'+d+' County</div>        <div class="track-attr-title">Population change: '+c+"</div>        <div>(2005 â€“ 2006)</div>      </div>",$("#pop-infowin").show().html(t).css({left:a+"px",top:f+"px"})},a.prototype.initPopulationMap=function(){function e(e,f,t){if(e)throw e;console.log("us",f,"states",t),console.log("years",a.years,"popChange",a.popChange),a.svg.append("g").attr("class","counties").selectAll("path").data(topojson.feature(f,f.objects.UScounties).features).enter().append("path").attr("class","county").style("fill",function(e){var f=(a.path.area(e),e.properties.STATE_FIPS+e.properties.CNTY_FIPS,a.years.year06.get(e.properties.STATE_FIPS+e.properties.CNTY_FIPS)),t=a.popChange.year06.get(e.properties.STATE_FIPS+e.properties.CNTY_FIPS),d=100*f;return 97>d?-3e3>t?a.o(d):"#FFF":d>103&&t>3e3?a.b(d):"#FFF"}).attr("d",a.path).on("mouseenter",function(e){d3.select(this).transition().duration(500).attr("stroke","#888");var f=[0,0];f=d3.mouse(this);var t=f[0],d=f[1];a._popInfo(e,t,d)}).on("mouseleave",function(e){d3.select(this).transition().duration(500).attr("stroke","#CCC")})}var a=this,f={top:10,left:10,bottom:10,right:10},t=parseInt(d3.select("#county-map").style("width")),t=t-f.left-f.right,d=.5,c=t*d;console.log("width:",t),console.log("height:",c),this.years={year04:d3.map(),year05:d3.map(),year06:d3.map()},this.popChange={year04:d3.map(),year05:d3.map(),year06:d3.map()},this.o=d3.scale.quantile().domain([0,100]).range(colorbrewer.Oranges[9]),this.b=d3.scale.quantile().domain([100,130]).range(colorbrewer.Blues[9]),this.projection=d3.geo.albersUsa().scale(t).translate([t/2,c/2]),this.path=d3.geo.path().projection(this.projection),this.svg=d3.select("#county-map").append("svg").attr("width",t).attr("height",c),queue().defer(d3.json,"data/us-detail.json").defer(d3.json,"data/us.json").defer(d3.csv,"data/pop.csv",function(e){if("0"===e.SEX&&"0"===e.ORIGIN&&"0"===e.RACE){e.STATE<10&&(e.STATE="0"+e.STATE),e.COUNTY<10?e.COUNTY="00"+e.COUNTY:e.COUNTY<100&&(e.COUNTY="0"+e.COUNTY);var f=e.POPESTIMATE2006/e.POPESTIMATE2005,t=e.POPESTIMATE2006-e.POPESTIMATE2005;a.years.year06.set(e.STATE+e.COUNTY,+f),a.popChange.year06.set(e.STATE+e.COUNTY,+t)}}).await(e),d3.select(a.frameElement).style("height",c+"px")},a.prototype.initOrleansChart=function(){c3.generate({bindto:"#orleans-pop-chart",data:{x:"x",columns:[["x",2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014],["Orleans Parish Population",485610,487363,489722,492187,493765,494294,230172,268751,301842,327803,347858,360877,370167,379006,384320]]}})},a.prototype.initPeopleChart=function(){c3.generate({bindto:"#human-age-chart",data:{columns:[["White",0,5,15,38,54,43,247],["Black",10,13,31,78,80,85,198]],type:"bar",colors:{White:"#c0b3bc",Black:"#a5cdb3"},groups:[["White","Black"]]},axis:{x:{type:"category",categories:["<18","18-29","30-44","44-54","55-64","65-74",">=74"]}}})},a.prototype.initHomesChart=function(){c3.generate({bindto:"#homes-chart",size:{height:250},bar:{width:30},padding:{left:90,right:20},color:{pattern:["#FABF62","#ACB6DD"]},data:{x:"x",columns:[["x","Hurricane Katrina","Sandy","Hurricane Andrew","Galveston Hurricane"],["Homes Damaged or Destroyed",662758,65e4,126495,3500]],type:"bar",color:function(e,a){var f=["#8bacbd","#8bacbd","#8bacbd","#8bacbd"];return void 0!==a.index?f[a.index]:e}},axis:{rotated:!0,x:{type:"category"}},tooltip:{grouped:!1},legend:{show:!1}})},a.prototype.initJobsCharts=function(){function e(e,a){console.log("jobs",a);c3.generate({bindto:"#unemployment-rate",size:{height:250},padding:{left:40,right:30},data:{json:a,type:"line",keys:{x:"Year",value:["unemployment_rate"]}},color:{pattern:["#34495e"]},axis:{x:{type:"category",tick:{count:3}}}}),c3.generate({bindto:"#labor-force",size:{height:250},padding:{left:50,right:50},data:{json:a,type:"line",keys:{x:"Year",value:["labor_force"]}},color:{pattern:["#34495e"]},axis:{x:{type:"category",tick:{count:3}}}})}queue().defer(d3.csv,"data/new-orleans-jobs.csv").await(e)},a.prototype.resize=function(){var e={top:10,left:10,bottom:10,right:10},a=.5,f=parseInt(d3.select("#county-map").style("width")),f=f-e.left-e.right,t=f*a;this.projection.translate([f/2,t/2]).scale(f),this.svg.style("width",f+"px").style("height",t+"px"),this.svg.selectAll(".county").attr("d",this.path)},a.prototype.wire=function(){var a=this;d3.select(e).on("resize",function(){a.resize()}),$("#animate-track").on("click",function(){a._animateTrack()})},e.App=a}(window),App.prototype.effects=function(){{var e=$.scrollorama({blocks:".section",enablePin:!1});$(window).height(),$(window).width()}e.animate("#main-title",{delay:0,duration:500,property:"padding-top",start:"12%",end:"23%"})};